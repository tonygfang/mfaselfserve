<!DOCTYPE html>
<html lang="en">
  <head>
    {{>head}}
    
    <script src="/assets/js/jwtdecoder.js"></script>
    
  </head>
  <body id="samples">

    {{>menu}}
    
    <div id="content" class="ui padded grid relaxed">
      <div id="doc" class="column eight wide">
        <div class="doc-overview">
          <h2 class="ui dividing header" data-se="overview-doc-header">
            My Tokens
          </h2>
          <p>Hello {{userinfo.name}}. Your OIDC tokens are below.
          </p>
          <p>This route is protected with the <code>oidc.ensureAuthenticated()</code> middleware, which will ensure that this page cannot be accessed until you have authenticated.</p>
          
        </div>

        <div class="ui form">
          <div class="field">
            <label>access_token jwt</label>
            <textarea id="access_token_jwt" readonly="">{{tokens.access_token}}</textarea>
          </div>
          
          <div class="field">
            <label>access_token header</label>
            <textarea id="access_token_header" readonly="" rows="4"></textarea>
          </div>
          <div class="field">
            <label>access_token payload</label>
            <textarea id="access_token_payload" readonly=""></textarea>
          </div>
          
          <div class="field">
            <label>id_token jwt</label>
            <textarea id="id_token_jwt" readonly="">{{tokens.id_token}}</textarea>
          </div>
          <div class="field">
            <label>id_token header</label>
            <textarea id="id_token_header" readonly="" rows="4"></textarea>
          </div>
          <div class="field">
            <label>id_token payload</label>
            <textarea id="id_token_payload" readonly=""></textarea>
          </div>
          
          <div class="field">
            <label>refresh_token</label>
            <textarea readonly="" rows="1">{{tokens.refresh_token}}</textarea>
          </div>
          <div class="field">
            <label>device_secret</label>
            <textarea readonly="" rows="1">{{tokens.device_secret}}</textarea>
          </div>
        </div>        
      </div>

      <script>
        const accessToken = decodeToken('{{tokens.access_token}}');
        const idToken = decodeToken('{{tokens.id_token}}');

        //console.log(`jwt ${accessToken.jwt}`);
        //console.log(`header ${accessToken.header}`);
        //console.log(`payload ${accessToken.payload}`);

        $('#access_token_header').text(accessToken.header);
        $('#access_token_payload').text(accessToken.payload);

        $('#id_token_header').text(idToken.header);
        $('#id_token_payload').text(idToken.payload);
      </script>

    </div>
  </body>
</html>
